---
name: write-tests
description: 为现有代码补充单元测试或集成测试的步骤与约定。在用户要求写测试、加测试、或提高覆盖率时使用。
---

# 编写测试

## 优先顺序

1. **核心逻辑**：业务规则、计算、状态转换。
2. **边界与错误**：空值、非法输入、异常分支。
3. **公共 API**：组件 props、导出函数、接口契约。

## 约定

- **命名**：`describe` 描述模块/组件，`it`/`test` 描述「在什么情况下应怎样」。
- **结构**：Arrange（准备）→ Act（执行）→ Assert（断言），必要时加简短注释。
- **隔离**：单测不依赖真实网络/DB，用 mock 或内存实现；共享状态要在用例间清理。
- **可读**：断言失败时能一眼看出「期望 vs 实际」，避免过度封装导致难以定位。

## 技术选型参考

- **React 组件**：Vitest + React Testing Library（或项目已有的测试框架）。
- **Node/ESM**：Vitest 或 Node 内置 test runner，按项目现有配置。
- **异步**：用 `async/await` 或框架的异步断言，避免裸 `setTimeout`。

## 输出

先说明要测的模块与场景，再给出具体测试代码；若项目已有测试目录与命名习惯，则遵循现有结构。
